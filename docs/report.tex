\input{settings}

\addbibresource{refs.bib}

% magic
\makeatletter
\newcommand{\stackover}{\genfrac{.}{.}\z@{}}
\makeatother

\begin{document}	% начало документа
\selectlanguage{russian}

% Титульная страница
\include{titlepage}

\tableofcontents
\newpage

\section{Введение}

За основу была взята статья ``Y.Ismail Ibrahim и H.Mohammed Khudhur,“Modified
three-term conjugate gradient algorithm and its applications in image
restoration”, Indonesian Journal of Electrical Engineering and Computer Science,
т. 28, No 3, с. 1510, дек. 2022, ISSN: 2502-4752. DOI: 10.11591/ijeecs.
v28.i3.pp1510-1517. url: http://dx.doi.org/10.11591/ijeecs.v28.i3.pp1510- 1517''.

При восстановлении изображений часто ставится цель вернуть высококачественную
версию изображения из его более низкокачественной копии. В рассмотренной статье
решается один вид задачи восстановления, а именно восстановление фотографий,
искаженных шумами в цифровых изображениях (также известных как шум ''соли и
перца''). Авторы данной статьи использовали алгоритм сопряженных градиентов для
восстановления изображений и удаления из них шумов, а также ими был разработан
алгоритм сопряженных градиентов с тремя ограничениями. Согласно результатам
численного анализа, созданный подход безусловно превосходит как метод
Флетчера и Ривза (FR), так и метод Флетчера и Ривза с тремя термами (TTFR).

\newpage
\section{Задача восстановления изображений}

\begin{figure}[ht]
    \centering
    \includegraphics[height=10\baselineskip]{salt_and_pepper.png}
    \caption{Пример шума ``соли и перца''}
    \label{fig:salt}
\end{figure}

Как было сказано ранее, данный алгоритм был создан для использования в задаче
фильтрации изображений с так называемым шумом ``соли и перца'', пример данного
дефекта изображен на рисунке (\ref{fig:salt}). Данный вид шума представляет
собой чередование чёрных и белых частиц и встречается, как правило, на
изображениях, поврежденных импульсным шумом. Этот вид шума возникает, когда
воздействию подвергается только малая часть пикселя, при этом информация о
фактических значениях поврежденных пикселей полностью теряется.

\begin{figure}[ht]
    \centering
    \includegraphics{lenaorig.jpg}
    \caption{Изображение Lena.png, часто используемое для демонстрации работы
    различных методов восстановления изображений}
    \label{fig:lena}
\end{figure}

Рисунок (\ref{fig:lena}) содержит изображение Lena.png, часто используемое в
задаче восстановления изображений в качестве тестового. Популярной метрикой при
оценке качества изображения при этом является индекс структурной схожести, также
используемый в данной работе.

\section{Особенности алгоритма}

Алгоритм обладает рядом преимуществ перед схожими методами:

\begin{enumerate}
    \item Обладает меньшим значением ошибки по сравнению с похожими методами
    \item Показывает лучшие результаты в задаче восстановления изображений при
    сравнении с использованием индекса структурного сходства
    \item Осуществляет филтрацию изображений с более высокой точностью по
    сравнению с другими методами, приведенными в статье
\end{enumerate}

\section{Семейство методов с тремя термами}
Три терма в данном случае - это три вектора, участвующие в каждой итерации
алгоритма и обозначаемые следующим образом:
\begin{enumerate}
    \item Вектор градиента ($g_{k}$): Этот вектор представляет собой градиент
    целевой функции на текущей итерации.
    \item Вектор направления поиска ($d_{k}$): Этот вектор представляет собой
    направление поиска, в котором алгоритм будет двигаться от текущей точки для
    поиска минимума.
    \item Вектор предыдущего направления поиска ($t_{k}$): Этот вектор
    представляет собой предыдущее направление поиска, использованное в процессе
    оптимизации.
\end{enumerate}
Алгоритм сопряженных градиентов с тремя термами включает в себя расчёт этих трех
векторов на каждой итерации на основе определенных условий и требований
сопряженности.

\noindent Все рассматриваемые методы используют одну формулу для нахождения
следующей точки, здесь $\chi_{k}$ - непосредственно точка, $\alpha_{k}$ - шаг,
$d_{k}$ - вектор направления поиска, а $k$ - номер итерации.

\noindent Авторы также приводят рабочие формулы схожих методов, рассматриваемых
в статье, среди которых FR - метод Флетчера-Ривза, PR - метод Полака-Рибьера, HS
- метод Хестенса-Штифеля:

\begin{enumerate}
    \item FR
    \begin{equation*}
        d_{k+1}=-\nabla F_{k+1}+\beta^{F R}d_{k}-\theta_{k}^{(1)}\nabla F_{k+1}
    \end{equation*}
    \begin{equation*}
        \beta_{k}^{F R}=\frac{{\cal \nabla}F_{k+1}^{T}{\cal \nabla}F_{k+1}}{{\cal \nabla}F_{k}^{T}{\cal \nabla}F_{k}} \text{\cite{art4}}; \
    \end{equation*}
    где $ \theta_{k}^{(1)}=\frac{d_{k}^{T}\nabla F_{k+1}}{\nabla F_{k}^{T}\nabla F_{k}} $
    \item PR
    \begin{equation*}
        d_{k+1}=-\nabla F_{k+1}+\beta^{P R P}d_{k}-\theta_{k}^{(1)}\nabla F_{k+1}
    \end{equation*}
    \begin{equation*}
        \beta_{k}^{P R P}=\frac{y_{k}^{T}\nabla F_{k+1}}{g_{k}^{T}g_{k}}\nonumber \text{\cite{art5}}; \
    \end{equation*}
    где $\theta_{k}^{(1)}=\frac{d_{k}^{T}\nabla F_{k+1}}{\nabla F_{k}^{T}\nabla F_{k}}$
    \item HS
    \begin{equation*}
        d_{k+1}=-\nabla F_{k+1}+\beta^{H S}d_{k}-\theta_{k}^{(1)}\nabla F_{k+1}
    \end{equation*}
    \begin{equation*}
        \beta_{k}^{H S}=\frac{y_{k}^{T}\nabla F_{k+1}}{\nabla F_{k}^{T}d_{k}} \text{\cite{art6}}; \
    \end{equation*}
    где $ \theta_{k}^{(1)}=\frac{d_{k}^{T}\nabla F_{k+1}}{d_{k}^{T}y_{k}} $
\end{enumerate}

\noindent Как видно, различные методы данного семейства отличаются друг от друга
значениями параметров $\beta$ и $\theta$.

\section{Предлагаемые модификации}

Авторы статьи используют сопряженное условие Дая и Ляо для нахождения параметра
$\theta$, а также усиленные условия Вольфе для нахождения оптимального шага
$\alpha_{k}$. При этом в данном алгоритме используется значение параметра
$\beta^{FR}$, взятое из метода Флетчера-Ривза.

\begin{equation}\label{eqn:eq7}
    \theta_{k}^{N E W}=-\lambda+\beta_{k}^{F R}\frac{y_{k}^{T}d_{k}}{y_{k}^{T}\nabla F_{k+1}}+\frac{s_{k}^{T}\nabla F_{k+1}}{y_{k}^{T}\nabla F_{k+1}}
\end{equation}
\begin{equation}\label{eqn:eq8}
    d_{k+1}=-\nabla F_{k+1}+\beta_{k}^{F R}d_{k}-\theta_{k}^{N E W} \nabla F_{k+1}
\end{equation}

\section{Результаты экспериментов}

Предложенный фильтр (HM) создан для обработки шума ''соли и перца'' в цифровых
изображениях, при воздействии на изображение шумом с различными коэффициентами
$\left(30,50,70,90\right)$. Зашумленные изображения были были обработаны
предложенным фильтром HR, а также фильтрами FR, TTFR и медианным фильтром из
системы MATLAB. Далее приведены результаты применения данного метода
на тестовых изображениях:

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{lena.png}
    \caption{Сравнение результатов удаления шума (Lena.png) 
    с использованием предложенного фильтра и других фильтров}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{barbara.png}
    \caption{Сравнение результатов удаления шума (Barbara.png) 
    с использованием предложенного фильтра и других фильтров}
\end{figure}

Для демонстрации результатов были выбраны изображения (Lena.png) и
(Barbara.png), известные в литературе и исследованиях по обработке цифровых
изображений. Изображение было обработано с использованием четырех коэффициентов
шума и упомянутых фильтров, а также предложенного фильтра.

Результаты представлены в таблице 1. Для измерения качества изображения
использовался индекс SSIM, большее значение индекса означает лучший результат.
Из таблицы видно, что при коэффициенте шума $30$ изображение, полученное в
результате обработки предложенным фильтром, совпало с оригинальным изображением
с отношением ($0.9600$). В то время как обработка фильтрами FR, TIFR и медианным
фильтром дала значения соответственно ($0.8853$), ($0.9168$) и ($0.6993$). То же
самое относится к другим коэффициентам шума. При воздействии на изображение с
коэффициентом шума $50$ результат обработки и сравнения с оригинальным
изображением составил ($0.9392$), при воздействии на изображение с коэффициентом
шума $70$ результат сравнения с оригинальным изображением составил ($0.8946$),
при воздействии на изображение с коэффициентом шума $90$ результат составил
($0.7877$).

\begin{table}[H]
    \centering
    \begin{tabular}{ccccccc}
        \hline
        \multicolumn{7}{c}{Lena} \\
        \hline
        Noise & original Image & noise Image & HM & FR & TTFR & median filtering \\
        30 & 1.0000 & 0.0526 & 0.9600 & 0.8853 & 0.9168 & 0.6993 \\
        50 & 1.0000 & 0.0262 & 0.9392 & 0.5419 & 0.8326 & 0.2321 \\
        70 & 1.0000 & 0.0138 & 0.8946 & 0.0885 & 0.7397 & 0.0527 \\
        90 & 1.0000 & 0.0061 & 0.7877 & 0.4311 & 0.6159 & 0.0115 \\
        \multicolumn{7}{c}{Barbara} \\
        Noise & original Image & noise Image & HM & FR & TTFR & median filtering \\
        30 & 1.0000 & 0.0959 & 0.9251 & 0.8305 & 0.9118 & 0.6213 \\
        50 & 1.0000 & 0.0465 & 0.8793 & 0.7180 & 0.7950 & 0.2351 \\
        70 & 1.0000 & 0.0224 & 0.7997 & 0.5255 & 0.6880 & 0.0587 \\
        90 & 1.0000 & 0.0081 & 0.6565 & 0.4141 & 0.5678 & 0.0129 \\
        \hline
    \end{tabular}
    \caption{}
\end{table}

\section{Реализация алгоритма}

Графическое изображение представленного алгоритма приведено на рисунке,
реализация алгоритма осуществлялась на языке Python. Рассмотрим схему работы
алгоритма:

\begin{figure}[ht]
    \centering
    \includegraphics[height=20\baselineskip]{algo.png}
    \caption{Общая схема алгоритма}
\end{figure}

\begin{enumerate}
    \item Берем начальную точку $x_{0}$, значение $\varepsilon > 0$ и $k=0$
    \item Находим значение $d_{0} = -\nabla F_{0}$ 
    \item Находим значение шага $\alpha_{k}$
    \item Если норма градиента меньше заданного $\varepsilon$, то необходимая
    точность достигнута, работа алгоритма завершается, в противном случае
    находим новый вектор поиска $d_{k}$
    \item Устанавливаем $k = k + 1$
\end{enumerate}

\newpage
\section{Заключение}

Были представлены различные методы фильтрации для уменьшения шума «соли и перца»
на изображениях в оттенках серого.

\noindent Произведено сравнение результатов различных методов.

\noindent Предложенный фильтр обеспечивает лучшую производительность по
сравнению с другими рассмотренными методами и качество изображения в целом.

\newpage
\nocite{*}
\printbibliography[heading=bibintoc]

\newpage
\section*{Приложение}
\addcontentsline{toc}{section}{Приложение}

\subsection{Код программы}

\lstinputlisting{method.py}

\includepdf[pages=1,offset=0 0, pagecommand={\subsection{Перевод статьи}\label{reference}\thispagestyle{plain}}
]{translation.pdf}

\includepdf[pages=2-,offset=0 0, pagecommand=\thispagestyle{plain}
]{translation.pdf}

\newpage
\includepdf[pages=1,offset=0 0, pagecommand={\subsection{Оригинальная статья}\label{reference}\thispagestyle{plain}}
]{Modified_three-term_conjugate_gradient_algorithm_a.pdf}

\includepdf[pages=2-,offset=0 0, pagecommand=\thispagestyle{plain}
]{Modified_three-term_conjugate_gradient_algorithm_a.pdf}

\end{document}
